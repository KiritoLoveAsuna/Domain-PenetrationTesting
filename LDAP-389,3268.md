### Enumeration
389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: hutch.offsec0., Site: Default-First-Site-Name)
```
Extract users:
ldapsearch -x -H ldap://192.168.151.122 -D '' -w '' -b "DC=hutch,DC=offsec" | grep sAMAccountName

Extract all info:
ldapsearch -x -H ldap://192.168.151.122 -D '' -w '' -b "DC=hutch,DC=offsec"

Extract description:
ldapsearch -x -H ldap://192.168.151.122 -D '' -w '' -b "DC=hutch,DC=offsec" | grep description

Extract naming context:
ldapsearch -H ldap://192.168.151.122 -x -s base namingcontexts

Nmap auto enum:
nmap -n -sV --script "ldap* and not brute" <IP> #Using anonymous credentials
```
### Enumerate domain users
```
enum4linux ip
```
### If you have valid credentials to login into the LDAP server, you can dump all the information about the Domain Admin using:
```
pip3 install ldapdomaindump 
ldapdomaindump <IP> [-r <IP>] -u '<domain>\<username>' -p '<password>' [--authtype SIMPLE] --no-json --no-grep [-o /path/dir]
```
```
If you find something saying that the "bind must be completed" means that the credentials are incorrect.

You can extract everything from a domain using:

Copy
ldapsearch -x -H ldap://<IP> -D '<DOMAIN>\<username>' -w '<password>' -b "DC=<1_SUBDOMAIN>,DC=<TLD>"
-x Simple Authentication
-H LDAP Server
-D My User
-w My password
-b Base site, all data from here will be given
```
### Brute-force
···
nmap --script ldap-brute -p 389 <IP>
legba ldap --target 127.0.0.1:389 --username admin --password @wordlists/passwords.txt --ldap-domain example.org --single-match
···
